import{d as y,o as n,c as u,t as w,Y as z,Z as D,f as t,g as l,F as N,i as C,h as g,_ as U,r as I,w as j,y as b,z as f,a as A,I as V,u as B,x,s as F,b as M,j as $,C as P,k as T,E,l as Q}from"./index-HA-C2-6D.js";import{e as R,_ as Z}from"./CartSummary.vue_vue_type_script_setup_true_lang-C8vWlLFP.js";import{u as Y,b as G}from"./cart-4v3HBVN5.js";const H={key:1},r=y({__name:"OrderTd",props:["width","label"],setup(s){return(c,p)=>s.label?(n(),u("td",{key:0,style:z(`width:${s.width}%;text-align:center`)},w(s.label),5)):(n(),u("td",H,[D(c.$slots,"default")]))}}),J={class:"table table-bordered"},K=["src"],W={style:{"margin-right":"2px"}},X=y({__name:"OrderCart",props:["orderList"],setup(s){return(c,p)=>(n(),u("table",J,[t("tr",null,[l(r,{width:"5",label:"#"}),l(r,{width:"15",label:"skuImg"}),l(r,{width:"20",label:"상품명"}),l(r,{width:"40",label:"skuDec"}),l(r,{width:"10",label:"qty"}),l(r,{width:"10",label:"price"})]),(n(!0),u(N,null,C(s.orderList,(e,o)=>(n(),u("tr",{class:"order_tbody",key:e.id},[l(r,{width:"5",label:o+1},null,8,["label"]),l(r,{width:"10"},{default:g(()=>[t("img",{src:e.skuInfo.skuDefaultImg,width:"50px;"},null,8,K)]),_:2},1024),l(r,{width:"20",label:e.skuInfo.spuName},null,8,["label"]),l(r,{width:"40"},{default:g(()=>[t("p",null,w(e.skuInfo.skuName),1),(n(!0),u(N,null,C(e.skuInfo.skuSaleAttrValueList,_=>(n(),u("span",W,w(`${_.saleAttrName}:${_.saleAttrValueName}`),1))),256))]),_:2},1024),l(r,{width:"10",label:e.qty},null,8,["label"]),l(r,{width:"10",label:e.skuInfo.goods_price_min*e.qty},null,8,["label"])]))),128))]))}}),ee=U(X,[["__scopeId","data-v-723fff9b"]]),te={class:"row"},se={class:"col-md-6 mb-3"},oe={class:"col-md-6 mb-3"},ae={class:"col-md-6 mb-3"},le={class:"col-12 mb-3"},re={class:"col-12 mb-3"},ce=A('<div class="col-12 mb-3"><textarea name="comment" class="form-control w-100" id="comment" cols="30" rows="10" placeholder="Leave a comment about your order"></textarea></div><div class="col-12"><div class="custom-control custom-checkbox d-block mb-2"><input type="checkbox" class="custom-control-input" id="customCheck2" checked><label class="custom-control-label" for="customCheck2">Create an accout</label></div><div class="custom-control custom-checkbox d-block"><input type="checkbox" class="custom-control-input" id="customCheck3" checked><label class="custom-control-label" for="customCheck3">Ship to a different address</label></div></div>',2),de=y({__name:"OrderForm",props:["user"],setup(s){let c=s;return I(!1),j([()=>c.user.firstName,()=>c.user.lastName,()=>c.user.address],([p,e,o])=>{p!=""&&e!=""&&o!=""&&R.emit("changeValid",{valid:!0})},{immediate:!0}),(p,e)=>(n(),u("form",null,[t("div",te,[t("div",se,[b(t("input",{type:"text",class:"form-control",id:"first_name","onUpdate:modelValue":e[0]||(e[0]=o=>s.user.firstName=o),placeholder:"First Name",required:""},null,512),[[f,s.user.firstName]])]),t("div",oe,[b(t("input",{type:"text",class:"form-control",id:"last_name","onUpdate:modelValue":e[1]||(e[1]=o=>s.user.lastName=o),placeholder:"Last Name",required:""},null,512),[[f,s.user.lastName]])]),t("div",ae,[b(t("input",{type:"text",class:"form-control",id:"zipCode","onUpdate:modelValue":e[2]||(e[2]=o=>s.user.zipCode=o),placeholder:"Zip Code"},null,512),[[f,s.user.zipCode]])]),t("div",le,[b(t("input",{type:"text",class:"form-control mb-3",id:"street_address","onUpdate:modelValue":e[3]||(e[3]=o=>s.user.address=o),placeholder:"Address"},null,512),[[f,s.user.address]])]),t("div",re,[b(t("input",{type:"text",class:"form-control mb-3",id:"number","onUpdate:modelValue":e[4]||(e[4]=o=>s.user.phoneNumber=o),placeholder:"phoneNumber"},null,512),[[f,s.user.phoneNumber]])]),ce])]))}}),q=(s,c)=>V({url:"/product/getOrder",params:{mode:s,dilivery:0,...c},method:"get"}),ne=s=>V({url:"/product/payment",data:s,method:"post"}),ue={class:"cart-table-area section-padding-100"},ie={class:"container-fluid"},me={class:"row"},pe=t("div",{class:"cart-title"},[t("h2",null,"Checkout")],-1),he={class:"col-12 col-lg-8"},be={class:"checkout_details_area mt-50 clearfix"},fe=t("div",{class:"payment-method"},[t("div",{class:"custom-control custom-checkbox mr-sm-2"},[t("input",{type:"checkbox",class:"custom-control-input",id:"cod"}),t("label",{class:"custom-control-label",for:"cod"},"Cash on Delivery")]),t("div",{class:"custom-control custom-checkbox mr-sm-2"},[t("input",{type:"checkbox",class:"custom-control-input",id:"paypal"}),t("label",{class:"custom-control-label",for:"paypal"},[Q("Paypal "),t("img",{class:"ml-15",src:"",alt:""})])])],-1),ve=y({__name:"index",setup(s){let c=B(),p=Y(),e=x([]),o=P(),_=T();x({id:"",skuId:"",orderId:"",orderQty:"",orderPrice:""});let k=I(""),v=x({id:"",userName:"",firstName:"",lastName:"",address:"",zipCode:"",phoneNumber:""});F(()=>{O()});const L=M(()=>{const d=e.reduce((a,m)=>(a+=m.skuInfo.price*m.qty,a),0),i=e.reduce((a,m)=>(a+=m.qty,a),0),h=e.reduce((a,m)=>(a+=m.skuInfo.goods_price_min*m.qty,a),0);return{price:d,num:i,priceMin:h}}),O=async()=>{if(Object.assign(v,c.userInfo),o.query.mode=="buyNow"){const{skuId:d,qty:i,mode:h}=o.query,a=await q(h,{skuId:d,qty:i});Object.assign(e,a.data)}else if(o.query.mode=="cart"){const{cartIds:d,mode:i}=o.query;k.value=d;const h=await q(i,{cartIds:d});Object.assign(e,h.data)}},S=async()=>{const d=e.map(a=>({id:"",skuId:a.skuInfo.id,orderId:"",orderQty:a.qty,orderPrice:a.skuInfo.goods_price_min}));if((await ne({user:v,orderList:d})).code==200){const a=c.userInfo.id;k.value!=""&&await G(a,k.value),E({type:"success",message:"결제완료"}),p.getCartTotal(a),_.replace("/home")}};return(d,i)=>(n(),u("div",ue,[t("div",ie,[t("div",me,[pe,l(ee,{orderList:$(e)},null,8,["orderList"]),t("div",he,[t("div",be,[l(de,{user:$(v)},null,8,["user"])])]),l(Z,{title:"Checkout",total:L.value,style:{"margin-top":"-50px"},mode:"pay",onPayment:S},{default:g(()=>[fe]),_:1},8,["total"])])])]))}});export{ve as default};
