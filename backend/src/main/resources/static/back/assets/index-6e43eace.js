import{u as ue}from"./setting-8de73cb3.js";import{d as ie,r,a as ce,D as pe,G as me,H as fe,e as u,I as _e,o as i,f as S,g as t,w as a,h as o,J as g,j as d,A as z,v as V,F as L,q as P,t as G,m as B,K as ge,L as C,M as ve,N as ye,O as be,P as ke,p as Ve,k as he,_ as Ce}from"./index-06005ebc.js";const we=I=>(Ve("data-v-ebd04f77"),I=I(),he(),I),Ue={key:0},xe={key:1},Ne={style:{flex:"auto"}},Se=we(()=>B("h4",null,"역할분배",-1)),ze={style:{flex:"auto"}},Ie=ie({__name:"index",setup(I){let v=r(1),w=r(5),D=r(0),p=r(!1),f=r(!1),b=r(""),H=r("rtl"),h=r([]),U=r(!1),R=r([]);const E=r(!0),T=r([]);let j=r([]),J=r(),A=ue(),n=ce({id:"",createTime:"",updateTime:"",nickName:"",username:"",avatar:"",roles:[],buttons:[],routes:[]});pe(()=>{y(),K()});const y=async(s=1)=>{v.value=s;const e=await me(v.value,w.value,b.value);console.log(e,"result"),e.code==200&&(j.value=e.data.rows,D.value=e.data.total)},K=async()=>{const{data:s}=await fe();R.value=s},Q=()=>{y(),b.value=""},W=()=>{A.refresh=!A.refresh},X=s=>{Object.assign(n,s),p.value=!0},Y=async s=>{(await ge(s.id)).code==200?(C({type:"success",message:"삭제 성공"}),y()):C({type:"error",message:"삭제 실패"})},Z=async()=>{const s=T.value.map(m=>m.id);(await ve(s)).code==200?(C({type:"success",message:"삭제 성공"}),y()):C({type:"error",message:"삭제 실패"})},$=()=>{n={id:"",createTime:"",updateTime:"",nickName:"",username:"",avatar:""},p.value=!0},ee=s=>{T.value=s},le=async s=>{f.value=!0,n=s;const{data:e}=await ye(s.id);h.value=e},te=s=>{const e=s.length;U.value=e===R.value.length,E.value=e>0&&e<R.value.length},ae=async()=>{(await be(n)).code==200?(C({type:"success",message:n.id?"업데이트 완료":"새로 추가 완료"}),p.value=!1,y()):C({type:"error",message:n.id?"업데이트 실패":"새로 추가 실패"})},se=async()=>{const s=[];h.value.forEach(m=>{s.push({roleId:m.id,userId:n.id,roleName:m.name})}),(await ke(n.id,s)).code==200&&(f.value=!1,y(v.value))};return(s,e)=>{const m=u("el-input"),k=u("el-form-item"),c=u("el-button"),q=u("el-form"),M=u("el-card"),_=u("el-table-column"),oe=u("el-tag"),ne=u("el-table"),re=u("el-pagination"),F=u("el-drawer"),O=u("el-checkbox"),de=u("el-checkbox-group"),x=_e("has");return i(),S(L,null,[t(M,{style:{height:"80px"}},{default:a(()=>[t(q,{inline:!0,class:"form"},{default:a(()=>[t(k,{label:"userName"},{default:a(()=>[t(m,{placeholder:"유저네임 입력하세요",modelValue:o(b),"onUpdate:modelValue":e[0]||(e[0]=l=>g(b)?b.value=l:b=l)},null,8,["modelValue"])]),_:1}),t(k,null,{default:a(()=>[t(c,{onClick:Q,disabled:!o(b)},{default:a(()=>[d("Search")]),_:1},8,["disabled"]),t(c,{type:"primary",plain:"",onClick:W},{default:a(()=>[d("reset")]),_:1})]),_:1})]),_:1})]),_:1}),t(M,{style:{margin:"10px 0px"}},{default:a(()=>[z((i(),V(c,{type:"primary",plain:"",size:"default",onClick:$},{default:a(()=>[d("유저 추가")]),_:1})),[[x,"btn.User.add"]]),z((i(),V(c,{size:"default",type:"danger",plain:"",onClick:Z,disabled:!T.value.length},{default:a(()=>[d("여러개 삭제")]),_:1},8,["disabled"])),[[x,"btn.User.remove"]]),t(ne,{style:{margin:"10px 0px"},border:"",data:o(j),onSelectionChange:ee},{default:a(()=>[t(_,{type:"selection",width:"60px",align:"center"}),t(_,{label:"#",align:"center",width:"80",type:"index"}),t(_,{label:"id",align:"center",prop:"id",width:"80"}),t(_,{label:"userName",align:"center",prop:"username",width:"100"}),t(_,{label:"닉네임",align:"center",prop:"nickName"}),t(_,{label:"유저 역할",align:"center"},{default:a(({row:l})=>[(i(!0),S(L,null,P(l.roles,N=>(i(),V(oe,{key:N.id,class:"ml-2"},{default:a(()=>[d(G(N.roleName),1)]),_:2},1024))),128))]),_:1}),t(_,{label:"createTime",align:"center",prop:"createTime","show-overflow-tooltip":""}),t(_,{label:"updateTime",align:"center",prop:"updateTime","show-overflow-tooltip":""}),t(_,{label:"비고",align:"center",width:"260px"},{default:a(({row:l})=>[z((i(),V(c,{icon:"User",size:"small",type:"primary",onClick:N=>le(l)},{default:a(()=>[d("역할분배")]),_:2},1032,["onClick"])),[[x,"btn.User.assgin"]]),z((i(),V(c,{icon:"Edit",size:"small",type:"success",onClick:N=>X(l)},{default:a(()=>[d("편집")]),_:2},1032,["onClick"])),[[x,"btn.User.update"]]),z((i(),V(c,{icon:"Delete",size:"small",type:"danger",onClick:N=>Y(l)},{default:a(()=>[d("삭제")]),_:2},1032,["onClick"])),[[x,"btn.User.remove"]])]),_:1})]),_:1},8,["data"]),t(re,{"current-page":o(v),"onUpdate:currentPage":e[1]||(e[1]=l=>g(v)?v.value=l:v=l),"page-size":o(w),"onUpdate:pageSize":e[2]||(e[2]=l=>g(w)?w.value=l:w=l),layout:" prev, pager, next,jumper,->,sizes, total",total:o(D),"page-sizes":[3,5,7,10],onSizeChange:e[3]||(e[3]=l=>y(o(v))),onCurrentChange:y},null,8,["current-page","page-size","total"]),t(F,{modelValue:o(p),"onUpdate:modelValue":e[8]||(e[8]=l=>g(p)?p.value=l:p=l),direction:o(H)},{header:a(()=>[o(n).id?(i(),S("h4",Ue,"유저 업데이트")):(i(),S("h4",xe,"유저 새로 추가"))]),default:a(()=>[t(q,{"label-width":"80px",rules:s.rules,ref_key:"inputValidate",ref:J},{default:a(()=>[t(k,{label:"유저 네임",prop:"username"},{default:a(()=>[t(m,{placeholder:"이름을 입력하세요",modelValue:o(n).username,"onUpdate:modelValue":e[4]||(e[4]=l=>o(n).username=l)},null,8,["modelValue"])]),_:1}),t(k,{label:"닉 네임",prop:"nickName"},{default:a(()=>[t(m,{placeholder:"닉네임을 입력하세요",modelValue:o(n).nickName,"onUpdate:modelValue":e[5]||(e[5]=l=>o(n).nickName=l)},null,8,["modelValue"])]),_:1}),t(k,{label:"비밀번호",prop:"password"},{default:a(()=>[t(m,{placeholder:"비밀번호를 입력하세요",modelValue:o(n).password,"onUpdate:modelValue":e[6]||(e[6]=l=>o(n).password=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["rules"])]),footer:a(()=>[B("div",Ne,[t(c,{onClick:e[7]||(e[7]=l=>g(p)?p.value=!1:p=!1)},{default:a(()=>[d("cancel")]),_:1}),t(c,{type:"primary",onClick:ae},{default:a(()=>[d("confirm")]),_:1})])]),_:1},8,["modelValue","direction"]),t(F,{modelValue:o(f),"onUpdate:modelValue":e[13]||(e[13]=l=>g(f)?f.value=l:f=l)},{header:a(()=>[Se]),default:a(()=>[t(q,null,{default:a(()=>[t(k,{label:"userName"},{default:a(()=>[t(m,{modelValue:o(n).username,"onUpdate:modelValue":e[9]||(e[9]=l=>o(n).username=l),disabled:""},null,8,["modelValue"])]),_:1}),t(k,{label:"역할 설정"},{default:a(()=>[t(O,{style:{width:"100%"},modelValue:o(U),"onUpdate:modelValue":e[10]||(e[10]=l=>g(U)?U.value=l:U=l),indeterminate:E.value},{default:a(()=>[d("Check all ")]),_:1},8,["modelValue","indeterminate"]),t(de,{modelValue:o(h),"onUpdate:modelValue":e[11]||(e[11]=l=>g(h)?h.value=l:h=l),onChange:te},{default:a(()=>[(i(!0),S(L,null,P(o(R),l=>(i(),V(O,{key:l.id,label:l},{default:a(()=>[d(G(l.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),footer:a(()=>[B("div",ze,[t(c,{onClick:e[12]||(e[12]=l=>g(f)?f.value=!1:f=!1)},{default:a(()=>[d("cancel")]),_:1}),t(c,{type:"primary",onClick:se},{default:a(()=>[d("confirm")]),_:1})])]),_:1},8,["modelValue"])]),_:1})],64)}}});const qe=Ce(Ie,[["__scopeId","data-v-ebd04f77"]]);export{qe as default};
