import{u as de}from"./setting-72b37cf5.js";import{d as ue,r,a as ie,D as ce,G as pe,H as me,e as u,I as _e,o as i,f as S,g as a,w as t,h as o,J as g,j as d,A as z,v as V,F as L,q as G,t as H,m as B,K as fe,L as C,M as ge,N as ve,O as ye,P as be,p as ke,k as Ve,_ as he}from"./index-7801d67b.js";const Ce=I=>(ke("data-v-4895a2d5"),I=I(),Ve(),I),we={key:0},Ue={key:1},xe={style:{flex:"auto"}},Ne=Ce(()=>B("h4",null,"역할분배",-1)),Se={style:{flex:"auto"}},ze=ue({__name:"index",setup(I){let v=r(1),w=r(5),D=r(0),m=r(!1),_=r(!1),b=r(""),J=r("rtl"),h=r([]),U=r(!1),R=r([]);const j=r(!0),T=r([]);let A=r([]),K=r(),E=de(),n=ie({id:"",createTime:"",updateTime:"",nickName:"",username:"",avatar:"",roles:[],buttons:[],routes:[]});ce(()=>{y(),Q()});const y=async(s=1)=>{v.value=s;const e=await pe(v.value,w.value,b.value);console.log(e,"result"),e.code==200&&(A.value=e.data.rows,D.value=e.data.total)},Q=async()=>{const{data:s}=await me();R.value=s},W=()=>{y(),b.value=""},X=()=>{E.refresh=!E.refresh},M=s=>{console.log(s),s.id?Object.assign(n,s):Object.assign(n,{id:"",createTime:"",updateTime:"",nickName:"",username:"",password:"",avatar:"",roles:[],buttons:[],routes:[]}),m.value=!0},Y=async s=>{(await fe(s.id)).code==200?(C({type:"success",message:"삭제 성공"}),y()):C({type:"error",message:"삭제 실패"})},Z=async()=>{const s=T.value.map(p=>p.id);(await ge(s)).code==200?(C({type:"success",message:"삭제 성공"}),y()):C({type:"error",message:"삭제 실패"})},$=s=>{T.value=s},ee=async s=>{_.value=!0,n=s;const{data:e}=await ve(s.id);h.value=e},le=s=>{const e=s.length;U.value=e===R.value.length,j.value=e>0&&e<R.value.length},ae=async()=>{(await ye(n)).code==200?(C({type:"success",message:n.id?"업데이트 완료":"새로 추가 완료"}),m.value=!1,y()):C({type:"error",message:n.id?"업데이트 실패":"새로 추가 실패"})},te=async()=>{const s=[];h.value.forEach(p=>{s.push({roleId:p.id,userId:n.id,roleName:p.name})}),(await be(n.id,s)).code==200&&(_.value=!1,y(v.value))};return(s,e)=>{const p=u("el-input"),k=u("el-form-item"),c=u("el-button"),q=u("el-form"),O=u("el-card"),f=u("el-table-column"),se=u("el-tag"),oe=u("el-table"),ne=u("el-pagination"),F=u("el-drawer"),P=u("el-checkbox"),re=u("el-checkbox-group"),x=_e("has");return i(),S(L,null,[a(O,{style:{height:"80px"}},{default:t(()=>[a(q,{inline:!0,class:"form"},{default:t(()=>[a(k,{label:"userName"},{default:t(()=>[a(p,{placeholder:"유저네임 입력하세요",modelValue:o(b),"onUpdate:modelValue":e[0]||(e[0]=l=>g(b)?b.value=l:b=l)},null,8,["modelValue"])]),_:1}),a(k,null,{default:t(()=>[a(c,{onClick:W,disabled:!o(b)},{default:t(()=>[d("Search")]),_:1},8,["disabled"]),a(c,{type:"primary",plain:"",onClick:X},{default:t(()=>[d("reset")]),_:1})]),_:1})]),_:1})]),_:1}),a(O,{style:{margin:"10px 0px"}},{default:t(()=>[z((i(),V(c,{type:"primary",plain:"",size:"default",onClick:M},{default:t(()=>[d("유저 추가")]),_:1})),[[x,"btn.User.add"]]),z((i(),V(c,{size:"default",type:"danger",plain:"",onClick:Z,disabled:!T.value.length},{default:t(()=>[d("여러개 삭제")]),_:1},8,["disabled"])),[[x,"btn.User.remove"]]),a(oe,{style:{margin:"10px 0px"},border:"",data:o(A),onSelectionChange:$},{default:t(()=>[a(f,{type:"selection",width:"60px",align:"center"}),a(f,{label:"#",align:"center",width:"80",type:"index"}),a(f,{label:"id",align:"center",prop:"id",width:"80"}),a(f,{label:"userName",align:"center",prop:"username",width:"100"}),a(f,{label:"닉네임",align:"center",prop:"nickName"}),a(f,{label:"유저 역할",align:"center"},{default:t(({row:l})=>[(i(!0),S(L,null,G(l.roles,N=>(i(),V(se,{key:N.id,class:"ml-2"},{default:t(()=>[d(H(N.roleName),1)]),_:2},1024))),128))]),_:1}),a(f,{label:"createTime",align:"center",prop:"createTime","show-overflow-tooltip":""}),a(f,{label:"updateTime",align:"center",prop:"updateTime","show-overflow-tooltip":""}),a(f,{label:"비고",align:"center",width:"260px"},{default:t(({row:l})=>[z((i(),V(c,{icon:"User",size:"small",type:"primary",onClick:N=>ee(l)},{default:t(()=>[d("역할분배")]),_:2},1032,["onClick"])),[[x,"btn.User.assgin"]]),z((i(),V(c,{icon:"Edit",size:"small",type:"success",onClick:N=>M(l)},{default:t(()=>[d("편집")]),_:2},1032,["onClick"])),[[x,"btn.User.update"]]),z((i(),V(c,{icon:"Delete",size:"small",type:"danger",onClick:N=>Y(l)},{default:t(()=>[d("삭제")]),_:2},1032,["onClick"])),[[x,"btn.User.remove"]])]),_:1})]),_:1},8,["data"]),a(ne,{"current-page":o(v),"onUpdate:currentPage":e[1]||(e[1]=l=>g(v)?v.value=l:v=l),"page-size":o(w),"onUpdate:pageSize":e[2]||(e[2]=l=>g(w)?w.value=l:w=l),layout:" prev, pager, next,jumper,->,sizes, total",total:o(D),"page-sizes":[3,5,7,10],onSizeChange:e[3]||(e[3]=l=>y(o(v))),onCurrentChange:y},null,8,["current-page","page-size","total"]),a(F,{modelValue:o(m),"onUpdate:modelValue":e[8]||(e[8]=l=>g(m)?m.value=l:m=l),direction:o(J)},{header:t(()=>[o(n).id?(i(),S("h4",we,"유저 업데이트")):(i(),S("h4",Ue,"유저 새로 추가"))]),default:t(()=>[a(q,{"label-width":"80px",rules:s.rules,ref_key:"inputValidate",ref:K},{default:t(()=>[a(k,{label:"유저 네임",prop:"username"},{default:t(()=>[a(p,{placeholder:"이름을 입력하세요",modelValue:o(n).username,"onUpdate:modelValue":e[4]||(e[4]=l=>o(n).username=l)},null,8,["modelValue"])]),_:1}),a(k,{label:"닉 네임",prop:"nickName"},{default:t(()=>[a(p,{placeholder:"닉네임을 입력하세요",modelValue:o(n).nickName,"onUpdate:modelValue":e[5]||(e[5]=l=>o(n).nickName=l)},null,8,["modelValue"])]),_:1}),a(k,{label:"비밀번호",prop:"password"},{default:t(()=>[a(p,{placeholder:"비밀번호를 입력하세요",modelValue:o(n).password,"onUpdate:modelValue":e[6]||(e[6]=l=>o(n).password=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["rules"])]),footer:t(()=>[B("div",xe,[a(c,{onClick:e[7]||(e[7]=l=>g(m)?m.value=!1:m=!1)},{default:t(()=>[d("cancel")]),_:1}),a(c,{type:"primary",onClick:ae},{default:t(()=>[d("confirm")]),_:1})])]),_:1},8,["modelValue","direction"]),a(F,{modelValue:o(_),"onUpdate:modelValue":e[13]||(e[13]=l=>g(_)?_.value=l:_=l)},{header:t(()=>[Ne]),default:t(()=>[a(q,null,{default:t(()=>[a(k,{label:"userName"},{default:t(()=>[a(p,{modelValue:o(n).username,"onUpdate:modelValue":e[9]||(e[9]=l=>o(n).username=l),disabled:""},null,8,["modelValue"])]),_:1}),a(k,{label:"역할 설정"},{default:t(()=>[a(P,{style:{width:"100%"},modelValue:o(U),"onUpdate:modelValue":e[10]||(e[10]=l=>g(U)?U.value=l:U=l),indeterminate:j.value},{default:t(()=>[d("Check all ")]),_:1},8,["modelValue","indeterminate"]),a(re,{modelValue:o(h),"onUpdate:modelValue":e[11]||(e[11]=l=>g(h)?h.value=l:h=l),onChange:le},{default:t(()=>[(i(!0),S(L,null,G(o(R),l=>(i(),V(P,{key:l.id,label:l},{default:t(()=>[d(H(l.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),footer:t(()=>[B("div",Se,[a(c,{onClick:e[12]||(e[12]=l=>g(_)?_.value=!1:_=!1)},{default:t(()=>[d("cancel")]),_:1}),a(c,{type:"primary",onClick:te},{default:t(()=>[d("confirm")]),_:1})])]),_:1},8,["modelValue"])]),_:1})],64)}}});const Te=he(ze,[["__scopeId","data-v-4895a2d5"]]);export{Te as default};
